var at=Object.defineProperty;var nt=(r,t,e)=>t in r?at(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var s=(r,t,e)=>(nt(r,typeof t!="symbol"?t+"":t,e),e);import{S as ht,i as rt,s as ct,k as m,q as U,a as M,y as ot,l as g,m as v,r as V,h as c,c as z,z as lt,n as k,b as O,D as h,A as dt,u as j,g as ut,d as ft,B as mt,o as gt,Y as vt}from"../chunks/index.6549efbf.js";import{B as pt}from"../chunks/blocks-shuffle-3.653eb648.js";const X=class{constructor(){s(this,"subscribers");this.subscribers={}}static getInstance(){return this.instance===void 0&&(this.instance=new X),this.instance}dispatch(t,e){const i=this.subscribers[t];i!==void 0&&Object.keys(i).forEach(a=>i[a](e))}register(t,e){const i=this.getNextId();return this.subscribers[t]||(this.subscribers[t]={}),this.subscribers[t][i]=e,{unregister:()=>{delete this.subscribers[t][i],Object.keys(this.subscribers[t]).length===0&&delete this.subscribers[t]}}}getNextId(){return X.nextId++}};let D=X;s(D,"nextId",0),s(D,"instance");const L=class{constructor(){s(this,"isRunning",!1);s(this,"animationId",0);s(this,"frameCount",0);s(this,"deltaTime",0);s(this,"dts",[]);s(this,"callbacks",[]);s(this,"eventBus",D.getInstance());s(this,"addUpdateCallback",t=>(this.callbacks.indexOf(t)===-1&&this.callbacks.push(t),this));s(this,"removeUpdateCallback",t=>{const e=this.callbacks.indexOf(t);return e!==-1&&this.callbacks.splice(e,1),this});s(this,"timeStart",0);s(this,"loop",()=>{if(this.isRunning===!1)return;this.animationId=requestAnimationFrame(this.loop),this.frameCount+=1;const t=performance.now(),e=(t-this.timeStart)/1e3;this.timeStart=t,this.dts.push(e),this.dts.length>10&&this.dts.shift(),this.deltaTime=this.dts.reduce((a,o)=>a+o,0)/this.dts.length;const i={frameCount:this.frameCount,deltaTime:this.deltaTime};this.callbacks.forEach(a=>{a(i)}),this.frameCount%10==0&&this.eventBus.dispatch("frame-10",i),this.frameCount%20==0&&this.eventBus.dispatch("frame-20",i),this.frameCount%50==0&&this.eventBus.dispatch("frame-50",i)});s(this,"start",()=>(this.isRunning===!1&&(this.animationId=requestAnimationFrame(this.loop)),this.isRunning=!0,this.timeStart=performance.now(),this.frameCount=0,this.deltaTime=0,this));s(this,"stop",()=>(this.isRunning=!1,cancelAnimationFrame(this.animationId),this.callbacks=[],this));s(this,"pause",()=>(this.isRunning=!1,this));s(this,"resume",()=>(this.isRunning=!0,this.animationId=requestAnimationFrame(this.loop),this));s(this,"onFrame",t=>(this.addUpdateCallback(t),this));s(this,"unRegisters",[]);s(this,"on",(t,e)=>(this.unRegisters.push(this.eventBus.register(t,e)),this));s(this,"dispose",()=>(this.stop(),this.unRegisters.forEach(t=>{t.unregister()}),this))}};let I=L;s(I,"instance"),s(I,"getInstance",()=>(L.instance||(L.instance=new L),L.instance));class bt{constructor(t){s(this,"canvas");s(this,"context");s(this,"container");s(this,"scale",1);s(this,"canvases",[]);s(this,"contexts",[]);s(this,"createCanvas",(t,e)=>{const i=document.createElement("canvas"),a=(Math.random()*1e5).toFixed(0);return i.id=`${t}-${a}`,i.style.position="absolute",i.style.zIndex=`${e}`,i});s(this,"selectLayer",t=>(t==="front"&&(this.canvas=this.canvases[0],this.context=this.contexts[0]),t==="middle"&&(this.canvas=this.canvases[1],this.context=this.contexts[1]),t==="back"&&(this.canvas=this.canvases[2],this.context=this.contexts[2]),this));s(this,"addUpdateCallback",t=>{I.getInstance().addUpdateCallback(t)});s(this,"onResize",()=>{if(this.container){const t=this.container.getBoundingClientRect();this.resize(t==null?void 0:t.width,t==null?void 0:t.height),this.fillBackground()}});s(this,"dispose",()=>{window.removeEventListener("resize",this.onResize)});s(this,"getWidth",()=>this.canvas.width);s(this,"getHeight",()=>this.canvas.height);s(this,"getCanvas",()=>this.canvas);s(this,"getContext",()=>this.context);s(this,"cX",()=>this.canvas.width/2);s(this,"cY",()=>this.canvas.height/2);s(this,"nGx",8);s(this,"nGy",8);s(this,"gX",()=>this.canvas.width/this.nGx);s(this,"gY",()=>this.canvas.height/this.nGy);s(this,"setGridCount",(t,e)=>{this.nGx=t,this.nGy=e});s(this,"gridColor","#333");s(this,"setGridColor",t=>{this.gridColor=t});s(this,"isShowGrids",!1);s(this,"showGrids",t=>(this.isShowGrids=t,this));s(this,"drawGrids",(t,e)=>{this.nGx=t||this.nGx,this.nGy=e||this.nGy,this.selectLayer("back");const i=this.getContext();i.save();const a=this.gX(),o=this.gY(),x=this.getWidth(),p=this.getHeight();i.strokeStyle=this.gridColor,i.setLineDash([5,7]),i.lineWidth=1.1;for(let l=1;l<this.nGx;l++){i.beginPath();const d=a*l;i.moveTo(d,0),i.lineTo(d,p),i.stroke()}for(let l=1;l<this.nGy;l++){i.beginPath();const d=o*l;i.moveTo(0,d),i.lineTo(x,d),i.stroke()}i.restore()});s(this,"clear",()=>{this.canvas.width=this.canvas.width+0});s(this,"fillBackground",t=>{const e=this.selectLayer("back").context;return e.fillStyle=t||"rgba(0,0,0,0)",e.fillRect(0,0,this.canvas.width,this.canvas.height),this.isShowGrids===!0&&this.drawGrids(),this});s(this,"fill",t=>{const e=this.context;return e.fillStyle=t||"rgba(0,0,0,0)",e.fillRect(0,0,this.canvas.width,this.canvas.height),this});s(this,"resize",(t,e)=>{for(let i=0;i<this.canvases.length;i++)this.canvases[i].width=t,this.canvases[i].height=e;return this});if(!t)throw new Error("No container is founded!");this.container=t,this.container.style.position="relative",this.canvases.push(this.createCanvas("bfs-canvas-front",3)),this.canvases.push(this.createCanvas("bfs-canvas-middle",2)),this.canvases.push(this.createCanvas("bfs-canvas-back",1));const e=this.container.getBoundingClientRect();for(let a=0;a<this.canvases.length;a++)this.contexts[a]=this.canvases[a].getContext("2d"),this.canvases[a].width=e.width,this.canvases[a].height=e.height,this.container.appendChild(this.canvases[a]);const i=this.selectLayer("back");this.canvas=i.canvas,this.context=i.context,window.addEventListener("resize",()=>this.onResize()),this.fillBackground()}}class xt extends bt{constructor(e){super(e);s(this,"arms",[]);s(this,"rAlpha",0);s(this,"drawCore",()=>{this.selectLayer("front");const e=this.getContext(),i=this.cX(),a=this.cY();e.save(),e.translate(i,a),e.lineWidth=this.gY()/6+Math.sin(this.rAlpha),e.fillStyle="#ffff",e.strokeStyle="#fff",e.beginPath(),e.arc(0,0,this.getHeight()/14+Math.sin(this.rAlpha+=.05)*1,0,Math.PI*2),e.stroke(),e.restore()});s(this,"drawArms",()=>{this.selectLayer("front"),this.clear(),this.arms.forEach(e=>{e.update()})});s(this,"update",()=>{this.drawArms(),this.drawCore()});this.arms.push(new H(this,3,-Math.PI/4)),this.arms.push(new H(this,2.5,Math.PI/2)),this.arms.push(new H(this,2,Math.PI)),this.addUpdateCallback(this.update)}}class H{constructor(t,e,i){s(this,"maxLength",0);s(this,"minLength",0);s(this,"armLength",0);s(this,"angleRad",0);s(this,"alpha",0);this.canvas=t,this.maxLength=t.getHeight()/3,this.minLength=this.maxLength/2,this.armLength=e*this.maxLength,this.angleRad=i,this.alpha=i}update(){const t=this.canvas.selectLayer("front").getContext(),e=this.canvas.cX(),i=this.canvas.cY();t.save(),t.translate(e,i);const a=this.angleRad+this.alpha*.1;t.rotate(a),t.beginPath(),t.fillStyle="#fff",t.strokeStyle="#fff",t.lineWidth=1.5+this.armLength*.05,t.translate(0,-this.armLength),t.beginPath(),t.arc(0,0,this.armLength*.25,0,Math.PI*2),t.stroke(),t.beginPath(),t.fillStyle="#fff",t.strokeStyle="#fff",t.lineWidth=.9;const o=this.armLength*.07;t.moveTo(0,0),t.lineTo(o,o),t.lineTo(0,this.armLength*1),t.lineTo(-o,o),t.closePath(),t.fill(),t.restore();const x=(Math.sin(this.alpha)+1)*.5;this.armLength=this.minLength+(this.maxLength-this.minLength)*x,this.alpha+=Math.PI/87}}function wt(r){var J,K,Q;let t,e,i,a,o,x,p,l,d,y,u,w,W,_,G=((J=r[0])==null?void 0:J.deltaTime.toFixed(2))+"",F,q,S,R=(1/((K=r[0])==null?void 0:K.deltaTime)).toFixed(2)+"",Y,B,T,E=((Q=r[0])==null?void 0:Q.frameCount)+"",N,C;return w=new pt({}),{c(){t=m("div"),e=m("div"),i=m("div"),a=m("button"),o=U("Lick"),x=M(),p=m("div"),l=M(),d=m("div"),y=m("div"),u=m("div"),ot(w.$$.fragment),W=M(),_=m("span"),F=U(G),q=M(),S=m("span"),Y=U(R),B=M(),T=m("span"),N=U(E),this.h()},l(n){t=g(n,"DIV",{class:!0});var f=v(t);e=g(f,"DIV",{class:!0});var P=v(e);i=g(P,"DIV",{class:!0});var $=v(i);a=g($,"BUTTON",{});var A=v(a);o=V(A,"Lick"),A.forEach(c),$.forEach(c),P.forEach(c),x=z(f),p=g(f,"DIV",{id:!0,class:!0}),v(p).forEach(c),f.forEach(c),l=z(n),d=g(n,"DIV",{});var Z=v(d);y=g(Z,"DIV",{class:!0});var tt=v(y);u=g(tt,"DIV",{class:!0});var b=v(u);lt(w.$$.fragment,b),W=z(b),_=g(b,"SPAN",{});var st=v(_);F=V(st,G),st.forEach(c),q=z(b),S=g(b,"SPAN",{});var et=v(S);Y=V(et,R),et.forEach(c),B=z(b),T=g(b,"SPAN",{});var it=v(T);N=V(it,E),it.forEach(c),b.forEach(c),tt.forEach(c),Z.forEach(c),this.h()},h(){k(i,"class","flex justify-center items-center h-full border"),k(e,"class","absolute bg-black/70 w-full h-full z-10"),k(p,"id","container"),k(p,"class","absolute w-64 h-64"),k(t,"class","flex justify-center relative"),k(u,"class","card-header flex flex-row space-x-3 text-xl"),k(y,"class","card card-hover m-2 variant-glass-tertiary pb-1")},m(n,f){O(n,t,f),h(t,e),h(e,i),h(i,a),h(a,o),h(t,x),h(t,p),O(n,l,f),O(n,d,f),h(d,y),h(y,u),dt(w,u,null),h(u,W),h(u,_),h(_,F),h(u,q),h(u,S),h(S,Y),h(u,B),h(u,T),h(T,N),C=!0},p(n,[f]){var P,$,A;(!C||f&1)&&G!==(G=((P=n[0])==null?void 0:P.deltaTime.toFixed(2))+"")&&j(F,G),(!C||f&1)&&R!==(R=(1/(($=n[0])==null?void 0:$.deltaTime)).toFixed(2)+"")&&j(Y,R),(!C||f&1)&&E!==(E=((A=n[0])==null?void 0:A.frameCount)+"")&&j(N,E)},i(n){C||(ut(w.$$.fragment,n),C=!0)},o(n){ft(w.$$.fragment,n),C=!1},d(n){n&&c(t),n&&c(l),n&&c(d),mt(w)}}}function Ct(r,t,e){let i;return gt(()=>{new xt(document.getElementById("container")).showGrids(!0),I.getInstance().on("frame-10",a=>{e(0,i=a)}).start()}),vt(()=>{}),[i]}class Lt extends ht{constructor(t){super(),rt(this,t,Ct,wt,ct,{})}}export{Lt as component};
